# emitter-writer
golang hackathon result

Общение между сервисами идет по http

## `EMITTER`

сервис который читает данные из amazon-meta.txt.gz, берёт `crc32(id) % WRITERS_COUNT` и шлёт в соответствующий ему `WRITER`. то есть не все данные шлются во все врайтеры, а делятся на равные части и шлются им поочереди.  
рейт - не более 1 записи в секунду (под конфигом).  
данные шлёт все что там есть - парсит всё, а не только то что мы выше можем указать.  
эмиттер заранее знает сколько врайтеров будет и на каких портах они будут слушать.

данные должны лежать на сервере в
/var/tmp/amazon-meta.txt.gz

запуск эмиnтера: `go run *.go -writers_ports 8081,8082,8083 -num 1`

Врайтеры будут на портах 8081,8082,8083

Задержка отправки во врайтер будет 1 секунда

## `WRITER`

Сервис который принимает по сети (http) данные и пишет на диск (workerX.txt)  
поднят в нескольких экземплярах, количество равно количеству воркеров. Т.е. сколько воркеров - столько врайтеров - столько файлов с данными.  
К данным добавляет поле Time (текущее значение времени)  
Данные пишет в файл соответствующего WORKERа  

запуск врайтера: `go run ./writer/main.go -port 8081 -num 1`

num - номер конкретного врайтера
